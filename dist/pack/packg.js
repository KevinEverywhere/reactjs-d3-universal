'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var _createClass=function(){function defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,'value'in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();var _d=require('d3'),d3=_interopRequireWildcard(_d),_react=require('react'),_react2=_interopRequireDefault(_react),_text=require('./text.js'),_text2=_interopRequireDefault(_text);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return call&&('object'==typeof call||'function'==typeof call)?call:self}function _inherits(subClass,superClass){if('function'!=typeof superClass&&null!==superClass)throw new TypeError('Super expression must either be null or a function, not '+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var PackG=function(_React$Component){function PackG(a){_classCallCheck(this,PackG);var _this=_possibleConstructorReturn(this,(PackG.__proto__||Object.getPrototypeOf(PackG)).call(this,a));return _this.state={previous:{},r:0,scaled:!1,x:0,y:0,zIndex:0},_initialiseProps.call(_this),_this.state={previous:{},r:0,scaled:!1,x:0,y:0,zIndex:0},_this}return _inherits(PackG,_React$Component),_createClass(PackG,null,[{key:'defaultProps',get:function get(){return{colorScale:function colorScale(){return null},d:{},id:'',idx:0,labels:[]}}}]),_createClass(PackG,[{key:'componentWillReceiveProps',value:function componentWillReceiveProps(a){(a.d.x!==this.props.d.x||a.d.y!==this.props.d.y)&&this.setState({r:a.d.r,x:a.d.x,y:a.d.y})}},{key:'render',value:function render(){var _this2=this,_props=this.props,a=_props.colorScale,b=_props.d,c=_props.idx,f=_props.labels;return _react2.default.createElement('g',{key:c,onClick:function onClick(h){h.stopPropagation(),b.children||_this2.handleZoom()},ref:function ref(h){return _this2.g=h},transform:'translate('+(this.state.x||this.props.d.x)+', '+(this.state.y||this.props.d.y)+')'},_react2.default.createElement('circle',{className:b.parent?b.children?'node':'node node--leaf':'node node--root',r:this.state.r||this.props.d.r,ref:function ref(h){return _this2.circle=h},style:{fill:b.children?a(b.depth):'white',stroke:'#fff',strokeWidth:'1.5px'}}),!b.children&&_react2.default.createElement(_text2.default,{d:b,idx:c,labels:f,r:this.state.r||this.props.d.r}))}}]),PackG}(_react2.default.Component);PackG.propTypes={colorScale:_react2.default.PropTypes.func,d:_react2.default.PropTypes.object,id:_react2.default.PropTypes.string,idx:_react2.default.PropTypes.number,labels:_react2.default.PropTypes.array};var _initialiseProps=function(){var _this3=this;this.handleZoom=function(){var a=document.getElementById(_this3.props.id+'-visual-container').getBoundingClientRect();if(!_this3.state.scaled){var b=d3.interpolate([_this3.state.x,_this3.state.y,_this3.state.r],[a.left+a.width/2,a.top+a.height/2,Math.min(a.width,a.height)/2]);_this3.setState({previous:_this3.g.previousElementSibling,scaled:!0}),document.getElementById(_this3.props.id+'-visual-container').appendChild(_this3.g);var c=0,f=d3.interval(function(){c+=0.1,_this3.setState({r:b(c)[2],x:b(c)[0],y:b(c)[1]}),0.9<c&&f.stop()},10)}else var _b=d3.interpolate([_this3.state.x,_this3.state.y,_this3.state.r],[_this3.props.d.x,_this3.props.d.y,_this3.props.d.r]),_c=0,_f=d3.interval(function(){_c+=0.1,_this3.setState({r:_b(_c)[2],x:_b(_c)[0],y:_b(_c)[1]}),0.9<_c&&(_f.stop(),_this3.state.previous.parentNode.insertBefore(_this3.g,_this3.state.previous.nextSibling),_this3.setState({scaled:!1}))},10);return!0}};exports.default=PackG;