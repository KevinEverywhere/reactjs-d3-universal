'use strict';Object.defineProperty(exports,'__esModule',{value:!0});exports.getLabels=exports.getPieLabels=exports.getLabelText=void 0;var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!(i&&_arr.length===i));_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i['return']&&_i['return']()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr))return sliceIterator(arr,i);throw new TypeError('Invalid attempt to destructure non-iterable instance')}}(),_typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&'function'==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj};var _react=require('react'),_react2=_interopRequireDefault(_react),_arcs=require('./arcs.js'),arcs=_interopRequireWildcard(_arcs),_text=require('../svg/text.js'),_text2=_interopRequireDefault(_text);function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var getLabelText=exports.getLabelText=function getLabelText(_ref){var _ref$arc=_ref.arc,a=void 0===_ref$arc?{}:_ref$arc,_ref$chartType=_ref.chartType,b=void 0===_ref$chartType?'':_ref$chartType,_ref$d=_ref.d,c=void 0===_ref$d?{}:_ref$d,_ref$labels=_ref.labels,e=void 0===_ref$labels?[]:_ref$labels;if(!e.length||!b)return appFuncs.logError({data:[a,b,c,e],loc:__filename,msg:'labels, chartType, and arc must be valid variables in labels.getLabelText(), returning empty string'}),'';switch(b.toLowerCase()){case'pie':{var _ret=function(){if(appFuncs._.isEmpty(a.data))return appFuncs.logError({data:[a,b,e],loc:__filename,msg:'arc.data must be a valid variable in labels.getLabelText(), returning empty string'}),{v:''};var f=[];return e.forEach(function(g,h){return f.push(_react2.default.createElement('tspan',{className:'label',key:g+'-'+h},a.data[g]+'  '))}),{v:f}}();if('object'==('undefined'==typeof _ret?'undefined':_typeof(_ret)))return _ret.v}case'scatterplot':case'bar':case'simple':{if(appFuncs._.isEmpty(c))return appFuncs.logError({data:c,loc:__filename,msg:'d must be a valid variable in labels.getLabelText(), returning empty string'}),'';var f='';return e.forEach(function(g){return f+=c[g]+' '}),f}default:return appFuncs.logError({data:b,loc:__filename,msg:'chartType not setup for labels.getLabelText() returning null'}),null;}};getLabelText.propTypes={arc:_react2.default.PropTypes.object,chartType:_react2.default.PropTypes.string,d:_react2.default.PropTypes.object,labels:_react2.default.PropTypes.array};var getPieLabels=exports.getPieLabels=function getPieLabels(_ref2){var _ref2$arc=_ref2.arc,a=void 0===_ref2$arc?{}:_ref2$arc,_ref2$chartHeight=_ref2.chartHeight,b=void 0===_ref2$chartHeight?200:_ref2$chartHeight,_ref2$chartWidth=_ref2.chartWidth,c=void 0===_ref2$chartWidth?200:_ref2$chartWidth,_ref2$idx=_ref2.idx,e=void 0===_ref2$idx?0:_ref2$idx,_ref2$labels=_ref2.labels,f=void 0===_ref2$labels?[]:_ref2$labels;if(appFuncs._.isEmpty(a)||!f.length)return appFuncs.logError({data:a,loc:__filename,msg:'arc and labels must be a valid variable in labels.getPieLabels(), returning null'}),null;var g=arcs.generateLabelArc({chartHeight:b,chartWidth:c,endAngle:a.endAngle,startAngle:a.startAngle}),_g$centroid=g.centroid(a),_g$centroid2=_slicedToArray(_g$centroid,2),h=_g$centroid2[0],i=_g$centroid2[1],j=(a.endAngle+a.startAngle)/2>Math.PI?-15:15,k=getLabelText({arc:a,chartType:'pie',labels:f});// tbd: automatic text sizing
// appFuncs.console('dir')(this.text.getComputedTextLength());
return k?_react2.default.createElement(_text2.default,{chartType:'pie',className:'',dx:j,dy:0,text:k,transform:'rotate(0)',x:h/2,xlinkHref:'#arc-'+e,y:i/2}):(appFuncs.logError({data:['chartType = pie',a,f],msg:'text needs to be a valid variable, check labels.getLabelText method, returning empty string'}),'')};getPieLabels.propTypes={arc:_react2.default.PropTypes.object,chartHeight:_react2.default.PropTypes.number,chartWidth:_react2.default.PropTypes.number,idx:_react2.default.PropTypes.number,labels:_react2.default.PropTypes.array};var getLabels=exports.getLabels=function getLabels(_ref3){var _ref3$arc=_ref3.arc,b=void 0===_ref3$arc?{}:_ref3$arc,_ref3$chartHeight=_ref3.chartHeight,c=void 0===_ref3$chartHeight?200:_ref3$chartHeight,_ref3$chartType=_ref3.chartType,e=void 0===_ref3$chartType?'':_ref3$chartType,_ref3$chartWidth=_ref3.chartWidth,f=void 0===_ref3$chartWidth?200:_ref3$chartWidth,a=_ref3.d,_ref3$idx=_ref3.idx,g=void 0===_ref3$idx?0:_ref3$idx,_ref3$labels=_ref3.labels,h=void 0===_ref3$labels?[]:_ref3$labels;if(!e)return appFuncs.logError({data:[b,e,a,h],loc:__filename,msg:'Chart type must be defined in labels.getLabels(), returning empty string'}),'';switch(e.toLowerCase()){case'pie':return getPieLabels({arc:b,chartHeight:c,chartType:e,chartWidth:f,idx:g,labels:h});default:{var i='';return h.forEach(function(j){return i+=a[j]+' '}),i}}};